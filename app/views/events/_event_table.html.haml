%table.table.xp-table
  %tr
    -unless @chapter or @user
      %th.srt= sort_link @search, :chapter_id, 'Chapter'
    %th.srt= sort_link @search, :name, 'Name'
    %th.srt= sort_link @search, :event_type_id, 'Event Type'
    %th.srt= sort_link @search, :date, 'Date'
    %th Applied?
    - if @chapter && !@user
      %th
      %th
    - if @user
      %th

  - @events.reverse.each do |event|
    - chapter = Chapter.find(event.chapter_id)
    - event_type = EventType.find(event.event_type_id)
    - unless event_type.name == 'Goblin Blanket'
      %tr
        -unless @chapter or @user
          %td= chapter.name
        %td= event.name
        %td= EventType.find(event.event_type_id).name
        %td= event.date
        - if event.applied == true
          %td.ln Yes
        - else
          %td.ln No
        - if @chapter and !@user
          - if event.applied == true
            %td= button_to 'Apply Event', @event, class: "btn", :disabled => true
          - else
            %td= link_to 'Apply Event', chapter_event_path(@chapter.id,event.id), class: "btn", method: :put
        - if @chapter and !@user
          %td= link_to 'View Attendees', chapter_event_path(@chapter.id,event.id), class: "btn"
        - if @user
          %td= link_to 'Attend', user_event_path(@user.id,event.id), class: "btn"

